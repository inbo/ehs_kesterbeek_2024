[["8-resultaten-edna-vissen.html", "8 Resultaten eDNA vissen", " 8 Resultaten eDNA vissen library(dplyr) library(simputation) library(tidyr) library(here) ## here() starts at C:/Users/charlotte_vandriessc/Documents/GitHub/ehs_kesterbeek_2024 library(ggplot2) library(stringr) library(vegan) ## Loading required package: permute ## Loading required package: lattice library(tibble) library(pheatmap) library(corrplot) ## corrplot 0.95 loaded source(&quot;./source/functions/f.read_excel_allsheets.R&quot;) # Inlezen van de txt-bestanden edna_rra_avg &lt;- read.delim( here(&quot;data&quot;,&quot;biotiek&quot;,&quot;vis&quot;,&quot;elektrisch&quot;,&quot;extern&quot;,&quot;ruw&quot;,&quot;AquatischBeheerCuratedAveragedRRA_Hellinger.txt&quot;), sep = &quot;\\t&quot;, header = TRUE, stringsAsFactors = FALSE, dec = &quot;.&quot; ) edna_rra &lt;- read.delim( here(&quot;data&quot;,&quot;biotiek&quot;,&quot;vis&quot;,&quot;elektrisch&quot;,&quot;extern&quot;,&quot;ruw&quot;,&quot;AquatischBeheerCuratedRRA_Hellinger.txt&quot;), sep = &quot;\\t&quot;, header = TRUE, stringsAsFactors = FALSE, dec = &quot;.&quot; ) # Zet de dataset om naar numeriek edna_rra_avg &lt;- edna_rra_avg %&gt;% mutate(across( .cols = -species, .fns = ~ as.numeric(gsub(&quot;,&quot;, &quot;.&quot;, .)) )) df_plot &lt;- edna_rra_avg %&gt;% pivot_longer( cols = -species, names_to = &quot;averaged_sample&quot;, values_to = &quot;relative_abundance&quot; ) # Labels aanpassen op X as voor visualisatie df_plot$averaged_sample &lt;- str_replace_all(df_plot$averaged_sample, c( &quot;averaged_E2024STF1009PC_KB_Zenne1_Aquatisch.Beheer_1&quot; = &quot;KB_Zenne_1&quot;, &quot;averaged_E2024STF992PC_KB_Molenbeek2a_Aquatisch.Beheer_1&quot; = &quot;KB_Molenbeek_2a&quot;, &quot;averaged_E2024STF1010PC_KB_Molenbeek2b_Aquatisch.Beheer_1&quot; = &quot;KB_Molenbeek_2b&quot;, &quot;averaged_E2024STF994PC_Kester4a_Aquatisch.Beheer_1&quot; = &quot;KB_Kester_4a&quot;, &quot;averaged_E2024STF995PC_Kester4b_Aquatisch.Beheer_1&quot; = &quot;KB_Kester_4b&quot; )) # plot relative abundance of species per sample ggplot(df_plot, aes(x = averaged_sample, y = relative_abundance, fill = species)) + geom_bar(stat = &quot;identity&quot;) + geom_text(aes(label = species), position = position_stack(vjust = 0.5), size = 1, color = &quot;black&quot;) + theme_minimal() + labs( x = &quot;Averaged Samples&quot;, y = &quot;Relative Abundance&quot;, title = &quot;Barplot of Averaged Relative Read Abundances&quot; ) + theme(axis.text.x = element_text(angle = 45, hjust = 1)) #verdere data visualisatie edna_rra_samples &lt;- edna_rra %&gt;% select(9:23) %&gt;% mutate(across(everything(), ~ as.numeric(gsub(&quot;,&quot;, &quot;.&quot;, .)))) edna_rra_samples[is.na(edna_rra_samples)] &lt;- 0 edna_rra_samples_transposed &lt;- t(edna_rra_samples) # -------- PCA -------- pca_result &lt;- prcomp(edna_rra_samples_transposed, scale = TRUE) pca_scores &lt;- as.data.frame(pca_result$x) pca_scores$sample &lt;- rownames(pca_scores) location_map &lt;- c( &quot;E2024STF1009PC_KB_Zenne1_Aquatisch.Beheer_1&quot; = &quot;KB_Zenne_1&quot;, &quot;E2024STF1009PC_KB_Zenne1_Aquatisch.Beheer_2&quot; = &quot;KB_Zenne_1&quot;, &quot;E2024STF1009PC_KB_Zenne1_Aquatisch.Beheer_3&quot; = &quot;KB_Zenne_1&quot;, &quot;E2024STF992PC_KB_Molenbeek2a_Aquatisch.Beheer_1&quot; = &quot;KB_Molenbeek_2a&quot;, &quot;E2024STF992PC_KB_Molenbeek2a_Aquatisch.Beheer_2&quot; = &quot;KB_Molenbeek_2a&quot;, &quot;E2024STF992PC_KB_Molenbeek2a_Aquatisch.Beheer_3&quot; = &quot;KB_Molenbeek_2a&quot;, &quot;E2024STF1010PC_KB_Molenbeek2b_Aquatisch.Beheer_1&quot; = &quot;KB_Molenbeek_2b&quot;, &quot;E2024STF1010PC_Molenbeek2b_Aquatisch.Beheer_2&quot; = &quot;KB_Molenbeek_2b&quot;, &quot;E2024STF1010PC_Molenbeek2b_Aquatisch.Beheer_3&quot; = &quot;KB_Molenbeek_2b&quot;, &quot;E2024STF994PC_Kester4a_Aquatisch.Beheer_1&quot; = &quot;KB_Kester_4a&quot;, &quot;E2024STF994PC_Kester4a_Aquatisch.Beheer_2&quot; = &quot;KB_Kester_4a&quot;, &quot;E2024STF994PC_Kester4a_Aquatisch.Beheer_3&quot; = &quot;KB_Kester_4a&quot;, &quot;E2024STF995PC_Kester4b_Aquatisch.Beheer_1&quot; = &quot;KB_Kester_4b&quot;, &quot;E2024STF995PC_Kester4b_Aquatisch.Beheer_2&quot; = &quot;KB_Kester_4b&quot;, &quot;E2024STF995PC_Kester4b_Aquatisch.Beheer_3&quot; = &quot;KB_Kester_4b&quot; ) pca_scores$location &lt;- location_map[pca_scores$sample] ggplot(pca_scores, aes(x = PC1, y = PC2, label = sample, color = location)) + geom_point(size = 4) + theme_minimal() + labs( x = &quot;PCA Component 1&quot;, y = &quot;PCA Component 2&quot;, title = &quot;PCA of Samples Based on Relative Abundance&quot; ) + scale_color_manual(values = c( &quot;KB_Zenne_1&quot; = &quot;darkblue&quot;, &quot;KB_Molenbeek_2a&quot; = &quot;darkgreen&quot;, &quot;KB_Molenbeek_2b&quot; = &quot;darkred&quot;, &quot;KB_Kester_4a&quot; = &quot;purple&quot;, &quot;KB_Kester_4b&quot; = &quot;darkorange&quot; )) # -------- Correlatieplot -------- species_names &lt;- c( &quot;Abramis brama&quot;, &quot;Perca fluviatilis&quot;, &quot;Squalius cephalus&quot;, &quot;Cyprinus carpio&quot;, &quot;Carassius unclassified&quot;, &quot;Pseudorasbora parva&quot;, &quot;Neogobius melanostomus&quot;, &quot;Alburnus sp.&quot;, &quot;Pungitius pungitius&quot;, &quot;Tinca tinca&quot;, &quot;Rhodeus amarus&quot;, &quot;Barbatula barbatula&quot;, &quot;Cottus perifretum&quot;, &quot;Rutilus rutilus&quot;, &quot;Esox lucius&quot;, &quot;Barbus barbus&quot;, &quot;Anguilla anguilla&quot;, &quot;Gasterosteus aculeatus&quot;, &quot;Leuciscus leuciscus&quot;, &quot;Gymnocephalus cernua&quot;, &quot;Scardinius erythrophthalmus&quot;, &quot;Gobio gobio&quot; ) colnames(edna_rra_samples_transposed) &lt;- species_names cor_matrix &lt;- cor(edna_rra_samples_transposed) corrplot(cor_matrix, method = &quot;circle&quot;, type = &quot;upper&quot;, addCoef.col = NULL, number.cex = 0.7, cl.cex = 0.7, tl.col = &quot;black&quot;, tl.srt = 45, tl.cex = 0.8, col = colorRampPalette(c(&quot;darkred&quot;, &quot;white&quot;, &quot;darkgreen&quot;))(200), cl.pos = &quot;r&quot;, cl.lim = c(-1, 1), diag = FALSE, mar = c(0,0,1,0)) ## Warning in text.default(pos.xlabel[, 1], pos.xlabel[, 2], newcolnames, srt = ## tl.srt, : &quot;cl.lim&quot; is not a graphical parameter ## Warning in text.default(pos.ylabel[, 1], pos.ylabel[, 2], newrownames, col = ## tl.col, : &quot;cl.lim&quot; is not a graphical parameter ## Warning in title(title, ...): &quot;cl.lim&quot; is not a graphical parameter "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
